
# 盖章页工具 - HTML可视化版本

## 目录结构

```
├── GaiZhangYe/
│   ├── core/                # 核心业务逻辑（保持不变）
│   ├── entrypoints/         # 入口脚本（需要修改）
│   │   └── gui.py           # 原GUI入口（已失效）
│   ├── web/                 # 新的HTML可视化模块
│   │   ├── app.py           # Flask应用主入口
│   │   ├── templates/       # HTML模板
│   │   │   └── index.html   # 主页面
│   │   └── static/          # 静态资源（CSS/JS/图片）
│   └── ...                  # 其他模块（保持不变）
└── run_web.py               # HTML服务启动脚本
```

## 安装与运行

### 1. 安装依赖

```bash
pip install flask
```

### 2. 运行服务

```bash
# 方式1：直接运行
python -m GaiZhangYe.web.app

# 方式2：使用启动脚本（需要创建）
```

### 3. 访问服务

在浏览器中访问：http://localhost:5000

## 功能说明

### 1. 准备盖章页
- 将需要盖章的PDF文件放入`Nostamped_PDF`目录
- 点击页面上的"开始处理"按钮
- 处理完成后，盖章页面图片将保存在`Stamped_Pages`目录

### 2. 盖章页覆盖
- 将盖章后的页面图片放入`images`目录
- 将需要覆盖的Word文件放入`TargetFiles`目录
- 点击页面上的"开始覆盖"按钮
- 处理完成后，结果文件将保存在`result_Word`和`result_PDF`目录

### 3. Word转PDF
- 将需要转换的Word文件放入指定目录
- 点击页面上的"开始转换"按钮
- 转换完成后，结果PDF文件将保存在`result_PDF`目录

## 核心技术

### 1. Flask
- 作为后端Web框架，提供HTTP服务
- 处理API请求和页面渲染

### 2. HTML/CSS/JavaScript
- 使用模板引擎渲染页面
- 实现响应式设计
- 通过JavaScript实现前后端交互

### 3. 核心业务逻辑
- 直接调用原有的Python核心代码
- 保持与原GUI版本相同的业务逻辑
- 无需修改core层代码

## 开发说明

### 1. 页面扩展
- 可以在templates目录下添加更多HTML页面
- 使用Flask的路由系统进行页面导航

### 2. 功能扩展
- 在app.py中添加新的API接口
- 在JavaScript中实现客户端逻辑
- 直接调用core层的服务类

### 3. 静态资源
- 所有CSS/JS/图片文件放在static目录下
- 使用url_for('static', filename='filename')引用

## 注意事项

1. **文件路径**：确保文件路径不包含特殊字符
2. **权限**：确保Web服务具有文件读写权限
3. **性能**：大文件处理可能需要较长时间，请耐心等待
4. **日志**：可以在控制台查看运行日志

## 与原GUI对比

| 特性 | GUI版本 | HTML版本 |
|------|---------|----------|
| 界面 | 桌面应用 | Web界面 |
| 安装 | 需要安装依赖 | 仅需浏览器 |
| 跨平台 | 有限 | 完全跨平台 |
| 扩展性 | 有限 | 强 |
| 维护 | 复杂 | 简单 |

## 后续优化

1. 实现文件上传功能
2. 添加实时进度显示
3. 实现多语言支持
4. 添加用户认证
5. 实现批量处理功能
6. 添加错误处理和日志显示
